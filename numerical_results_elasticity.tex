\chapter{Numerical Results - Elasticity} \label{chapter:numerical_results_elasticity}

In the following chapter, results on elasticity are presented.
The validation of the FFT-based Galerkin formulation is performed on elastic materials at
small strains and large strains.
At large strains two different models are considered, the Saint Venant-Kirchhoff
constitutive model and the Hencky constitutive model.

It is important to remark that all the numerical results shown in this chapter are obtained
in the same machine with the specifications provided in Table~\ref{tab:specifications}.
Unless otherwise stated, each numerical simulation is performed only with 1 CPU core.

\begin{table}[htbp]
\caption{Specifications of the numerical testing machine.}
\label{tab:specifications}
\centering
\begin{tabular}{clc}
\hline\hline & \vphantom{\Big |}Model & \(2 \times\) Intel Xeon E5-2650 v4 \\
& \vphantom{\Big |}Microarchitecture & Broadwell \\
& \vphantom{\Big |}Base/Max Frequency & \(2.20 / 2.90 \mathrm{GHz}\) \\
\multirow{2}{*} {CPU} & \vphantom{\Big |}Num. of cores/threads & \(24 / 48(2 \times 12 / 24)\) \\
& \vphantom{\Big |}Ll Cache & \(718 \mathrm{KiB}(2 \times 384 \mathrm{KiB})\) \\
& \vphantom{\Big |}L2 Cache & \(6 \mathrm{MiB}(2 \times 3 \mathrm{MiB})\) \\
& \vphantom{\Big |}L3 Cache & \(60 \mathrm{MiB}(2 \times 30 \mathrm{MiB})\) \\
& \vphantom{\Big |}Numerical features & SSE3 SSSE3 AVX2 \\
\hline \multirow{2}{*} {Memory } & \vphantom{\Big |}Capacity & \(128 \mathrm{~GB}(8 \times 16 \mathrm{~GB})\) \\
& \vphantom{\Big |}Specification & DDR4 @ \(2400 \mathrm{MHz}\) \\
\hline\hline
\end{tabular}
\end{table}

\section{Material characterization} \label{sec:microstructures}

To perform several numerical applications systematically, the same microstructures are considered throughout the entire chapter.
Without any loss of generality in what concerns the objectives of the following studies, two types of periodic microstructures are addressed following \cite{ferreira_accurate_2020}:

\begin{description}
  \item[2D microstructure] Fiber-reinforced composite characterized by unidirectional circular cross-section fibers (phase 2, \(f=30 \%\) ) randomly distributed and embedded in a matrix (phase 1, \(f=70 \%)\)\footnote{This type of microstructure is suitable to be modeled in plane strain conditions by considering any transversal plane
relative to the fibers direction.} - see Figure~\ref{subfig:2d_microstructure};

  \item[3D microstructure] Particle-reinforced composite characterized by spherical particles (phase 2, \(f=20 \%\) ) randomly distributed and embedded in a matrix (phase 1, \(f=80 \%)\) - see Figure \ref{subfig:3d_microstructure}.
\end{description}

The assumed material properties for each phase are presented in Table~\ref{tab:mat_properties}.
At small strains, the material considered is linear elastic and at large strains, two constitutive models are considered.
The Saint Venant-Kirchhoff and Hencky constitutive models, both to be introduced next.

\begin{table}[htbp]
  \caption{Material properties for both fiber-reinforced (2D) and particle-reinforced (3D) composites.}
\label{tab:mat_properties}
  \centering
  \begin{tabular}{cccc}
  \vphantom{\Big |}Property & SI Units & Phase 1 & Phase 2 \\
  \hline\hline \vphantom{\Big |}\(E\) & \(\mathrm{~Pa}\) & \(100 \times 10^{6}\) & \(500 \times 10^{6}\) \\
  \(v\) & \(-\) & \(0.30\) & \(0.19\) \\
  \hline\hline
  \end{tabular}
\end{table}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{0.45\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/2d_microstructure}
    \caption{}
    \label{subfig:2d_microstructure}
  \end{subfigure} \hfill
  \begin{subfigure}[b]{0.45\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/3d_microstructure}
    \caption{}
    \label{subfig:3d_microstructure}
  \end{subfigure}
  \caption{Dual phased heterogeneous materials microstructure: \subref{subfig:2d_microstructure} Fiber-reinforced composite (randomly distributed unidirectional circular cross-section fibers, \(f=30\%\)) - 2D RVE; \subref{subfig:3d_microstructure} Particle-reinforced composite (randomly distributed particles, \(f=20\%\)) - 3D RVE.}
\label{fig:microstructure}
\end{figure}



\subsection{Saint Venant-Kirchhoff model}

One of the simplest constitutive models to consider is a hyper-elastic model defined in the reference configuration.
Note that the problem is still non-linear because of the geometric nonlinearity.
According to \cite{de_geus_finite_2017} it can be described as follows.

\paragraph{Constitutive model}
The model is defined in the undeformed configuration and it involves a linear relation between the second Piola-Kirchhoff stress \(\boldsymbol{S}\) and the Green-Lagrange strain \(\boldsymbol{E}\)
\begin{equation} \label{eq:saint_venant_constitutive_equation}
\boldsymbol{S}=\boldsf{D}^e: \boldsymbol{E},
\end{equation}
wherein \(\boldsf{D}^e\) is the standard fourth-order elastic stiffness tensor
\begin{equation}
\boldsf{D}^e\equiv\lambda \boldsymbol{I} \otimes \boldsymbol{I}+2 \mu \boldsf{I}_{S},
\end{equation}
with Lam√©'s constants \(\lambda\) and \(\mu\). In terms of Young's modulus, \(E\), and Poisson's ratio, \(\nu\), they read
\begin{equation}
\lambda=\frac{E \nu}{(1+\nu)(1-2 \nu)}, \qquad \mu=\frac{E}{2(1+\nu)}.
\end{equation}
Furthermore, \(\boldsymbol{I}\) is the second-order identity tensor and \(\boldsf{I}_{S}\) is the fourth-order symmetrization tensor\footnote{The fourth order symmetrization tensor is defined as \({(\mathsf I_S)}_{ijkl} = \frac{1}{2}(\delta_{ik}\delta_{jl} + \delta_{il}\delta_{jk})\).}.

The connection to the deformation gradient tensor \(\boldsymbol{F}\) and the first Piola-Kirchhoff stress \(\boldsymbol{P}\) is made by the definition of the Green-Lagrange strain
\begin{equation}
\boldsymbol{E}=\frac{1}{2}\left(\boldsymbol{F}^{T}\boldsymbol{F}-\boldsymbol{I}\right),
\end{equation}
and of the first Piola-Kirchhoff stress
\begin{equation} \label{eq:stress_relation_saint_venant_kirchhoff}
\boldsymbol{P}=\boldsymbol{F} \boldsymbol{S}.
\end{equation}

\paragraph{Consistent tangent}
The constitutive model is linearized in the reference configuration following Equation~\eqref{eq:newton_increment}.
Its derivation is straightforward.
The first step is to linearize the stress relation in Equation~\eqref{eq:stress_relation_saint_venant_kirchhoff}, leading to
\begin{equation} \label{eq:saint_venant_kirchhoff_stress_lin}
\delta \boldsymbol{P}^{T}=\boldsymbol{S}^{(i)}\delta \boldsymbol{F}^{T}+\boldsf{I}_{R T}:\left(\boldsymbol{F}^{(i)}\delta \boldsymbol{S}\right),
\end{equation}
wherein \(\boldsf{I}_{R T}\) is the fourth-order right-transposed identity tensor\footnote{The fourth-order right-transposed identity tensor is defined as \((\mathsf I_{RT})_{ijkl} = \delta_{ik}\delta_{jl}\).}.
The constitutive model in Equation~\eqref{eq:saint_venant_constitutive_equation} is already linear.
Combined with the linearization of the Green-Lagrange strain one obtains
\begin{equation} \label{eq:saint_venant_kirchhoff_increment_2nd_piola}
\delta \boldsymbol{S}=\boldsf{D}^e:\left(\boldsf{I}^{s}{\boldsymbol{F}^{(i)}}^{T}\right): \delta \boldsymbol{F}.
\end{equation}
The expression of the tangent stiffness follows by combining Equations~\eqref{eq:saint_venant_kirchhoff_stress_lin} and \eqref{eq:saint_venant_kirchhoff_increment_2nd_piola} to obtain
\begin{equation}
\boldsf{A}^{(i)}=\boldsymbol{S}^{(i)}\boldsf{I}+\boldsf{I}_{R T}:\left(\boldsymbol{F}^{(i)}  \boldsf{D}^e  {\boldsymbol{F}^{(i)}}^{T}\right): \boldsf{I}_{R T},
\end{equation}
whereby the right-symmetry of \(\boldsf{D}^e\) has been used to absorb \(\boldsf{I}_{S}\).

\subsection{Hencky model}

The Hencky model is the finite logarithmic strain-based extension of the standard linear elastic material.
According to \cite{de2008computational} it can be described as follows.

\paragraph{Constitutive model}
Let \(\varepsilon\) be the Eulerian logarithmic strain tensor
\begin{equation} \label{eq:def_eulerian_log_strain}
\varepsilon \equiv \ln \boldsymbol{V}=\frac{1}{2} \ln \boldsymbol{B}.
\end{equation}
The Hencky strain-energy function is defined in compact form as
\begin{equation}
\bar{\rho} \psi(\varepsilon)=\frac{1}{2} \varepsilon: \boldsf{D}^e: \varepsilon,
\end{equation}
where \(\boldsf{D}^e\) has the format of the infinitesimal isotropic elasticity tensor
\begin{equation}
\boldsf{D}^e \equiv 2 G \boldsf{I}_{S}+\left(K-\frac{2}{3} G\right) \boldsymbol{I} \otimes \boldsymbol{I},
\end{equation}
where \(G\) is the shear modulus and \(K\) the bulk modulus.

The above strain-energy renders the following linear relationship between the Kirchhoff stress and the Eulerian logarithmic strain
\begin{equation} \label{eq:hencky_stres_relation}
\bm\tau=\bar{\rho} \frac{\partial \psi}{\partial \varepsilon}=\boldsf{D}^e: \varepsilon,
\end{equation}
which has the same functional format as the infinitesimal linear elastic stress-strain relation.

\paragraph{Consistent tangent}

Under material isotropy, where \(\boldsymbol{\tau}\) can be expressed as a function of \(\boldsymbol{B}\) only, the spatial elasticity tensor can be equivalently represented as
\begin{equation} \label{eq:hecky_spatial_tangent_moduli_1st}
\boldsf{a}=\frac{2}{J} \frac{\partial \bm \tau}{\partial \bm B} \bm B-\boldsf{I}_{RT}\bm \sigma .
\end{equation}

As the Kirchhoff stress for the Hencky material is a linear function of the logarithmic Eulerian strain which, through its definition \eqref{eq:def_eulerian_log_strain}, is a function of \(B\), the derivative \(\partial \tau / \partial \boldsymbol{B}\) can be derived by a straightforward application of the chain rule to \eqref{eq:hencky_stres_relation}.
This gives
\begin{equation} \label{eq:hencky_1st_exp_for_deriv_tau_B}
\frac{\partial \boldsymbol{\tau}}{\partial \boldsymbol{B}}=\frac{\partial \boldsymbol{\tau}}{\partial \varepsilon}: \frac{\partial \varepsilon}{\partial \boldsymbol{B}}=\frac{1}{2} \boldsf{D}^e: \boldsf{L},
\end{equation}
where
\begin{equation}
\boldsf{L} \equiv \frac{\partial(\ln \boldsymbol{B})}{\partial \boldsymbol{B}},
\end{equation}
is the derivative of the tensor logarithm function evaluated at \(\bm B\).

In order to derive a compact expression for the Hencky elasticity tensor, we note that \eqref{eq:hecky_spatial_tangent_moduli_1st} is equivalent to
\begin{equation} \label{eq:hecky_spatial_tangent_moduli_2nd}
\boldsf{a}=\frac{1}{J}\frac{\partial \boldsymbol{\tau}}{\partial \boldsymbol{B}}: \boldsf{B}-\boldsf{I}_{RT}\bm\sigma
\end{equation}
where we have defined the fourth-order tensor \(\boldsf{B}\) by
\begin{equation}
\boldsf{B} \equiv 2\boldsf{I}_S \bm B.
\end{equation}
Finally, formula \eqref{eq:hecky_spatial_tangent_moduli_2nd} together with \eqref{eq:hencky_1st_exp_for_deriv_tau_B} yields the following expression for the Hencky spatial elasticity tensor
\begin{equation}
\boldsf{a}=\frac{1}{2 J}\boldsf{D}^e: \boldsf{L}: \boldsf{B}-\boldsf{I}_{RT}\bm\sigma,
\end{equation}
which has a particularly simple format.
The pull-back to the material configuration is given by
\begin{equation} \label{eq:space_consistent_tangent}
  \boldsf{A}^{(i)} = {\bm F^{(i)}}^{-1}\left(\frac{1}{2}\boldsf{D}^e:{\boldsf L}^{(i)}: {\boldsf B}^{(i)} - \boldsf{I}_{RT}\bm \tau^{(i)}\right){\bm F^{(i)}}^{-T},
\end{equation}
reintroducing the dependency on the current Newton iteration \((i)\).

\section{Comparison between FFT and FEM-based homogenization}


To better gauge the accuracy and efficiency of the FFT-based Galerkin formulation, some numerical simulations are performed.
Their goals is to (1) validate the implementation of the FFT-based homogenization Galerkin scheme \citep{vondrejc_fft-based_2014, zeman_finite_2017, de_geus_finite_2017}, (2) compare the accuracy and computational performance between the FFT, basic \citep{moulinec_fast_1994} and Galerkin formulation, and FEM-based homogenization approaches and (3) choose the suitable spatial discretization refinement to evaluate the microstructures in Figure~\ref{fig:microstructure}.

Concerning the FFT-based homogenization, the same discretization is performed in the different problem dimensions \(\left(n_{v, 1}=n_{v, 2}=n_{v, 3}\right)\).
To generate the FEM finite element meshes, the FFT-FEM mesh conversion strategy adopted is to convert the pixels (2D) and voxels (3D) into quadrilateral (2D) and brick (3D) finite elements.
It is employed with both linear (QUAD4, HEXA8) and quadratic finite elements (QUAD8, HEXA20) such that \(n_{e}=n_{v}\).
Moreover, given the solver library available in LINKS, two types of solvers are considered in the FEM-based homogenization simulations: the direct solver MKL PARDISO \citep{schenk2001pardiso, schenk2004solving} and the iterative solver WSMP (Watson Sparse Matrix Package) \citep{gupta_improved_2002, gupta_wsmp_2002} with an SSOR (Symmetric Successive Over-relaxation) preconditioner.
Extensive preliminary research has shown that these are the overall (solver time and memory footprint) best direct and iterative solvers available in Links \citep{cardoso_coelho_election_2019}.

\subsection{Small strain}

\paragraph{Comparison of the convergence criteria}
The following numerical results are presented to provide a better understanding of the differences in efficiency and accuracy between the two convergence criteria detailed in Section~\ref{sec:criteria}.

Both phases are assumed linear elastic (see Table~\ref{tab:mat_properties} for the properties), periodic boundary conditions are adopted and the following macroscale strain loading case is considered
\begin{equation}
\text { uniaxial: } \bm{\varepsilon}=\left[\begin{array}{lll}
5 & 0 & 0 \\
0 & 0 & 0 \\
0 & 0 & 0
\end{array}\right] \times 10^{-3},
\end{equation}
being enforced in a single load increment.
Note that in the 2D plane strain case, only the inplane \(O_{x y}\) macroscale strain components are enforced.

The numerical results of the fiber-reinforced linear elastic composite equilibrium problem using the two criteria under analysis are shown in Figure~\ref{fig:linear_2D_normal_comparison_crit} for the uniaxial loading case.
Figure~\ref{subfig:linear_2D_normal_comparison_crit_homo_stress_11_vs_n_voxels} shows that both FFT techniques converge to the same value at approximately the same rate as a function of the number of voxels in the discritization.
Also, no noticeable difference can be seen between the two convergence criteria considered.
Regarding the CPU time expended to reach an error of \num{1e-6}, presented in Figure~\ref{subfig:linear_2D_normal_comparison_crit_cpu_time_vs_n_voxels}, Criterion I leads to faster convergence.
This effect is stronger for the FFT Basic scheme.

\begin{figure}[hbt] % fig:linear_2D_normal_comparison_crit
  \centering
	\begin{subfigure}[b]{0.51\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_2D_normal_comparison_crit_homo_stress_11_vs_n_voxels}
    \caption{}
    \label{subfig:linear_2D_normal_comparison_crit_homo_stress_11_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{0.48\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_2D_normal_comparison_crit_cpu_time_vs_n_voxels}
    \caption{}
    \label{subfig:linear_2D_normal_comparison_crit_cpu_time_vs_n_voxels}
  \end{subfigure}
  \caption{Comparison between the Criterion I and II for FFT-based homogenization
  approaches, Galerkin and Basic, in the solution of the fiber-reinforced linear elastic
  composite equilibrium problem under uniaxial strain loading conditions:
  \subref{subfig:linear_2D_normal_comparison_crit_homo_stress_11_vs_n_voxels} Homogenized
  stress; \subref{subfig:linear_2D_normal_comparison_crit_cpu_time_vs_n_voxels}
  Computational time.}
  \label{fig:linear_2D_normal_comparison_crit}
\end{figure}

The numerical results of the particle-reinforced linear elastic composite equilibrium problem are shown in Figure~\ref{fig:linear_3D_normal_comparison_crit} for the uniaxial loading case.
The results mirror the ones found for the two-dimensional example.
Figure~\ref{subfig:linear_3D_normal_comparison_crit_homo_stress_11_vs_n_voxels} shows that both FFT techniques converge to the same value at approximately the same rate as a function of the number of voxels in the discritization.
Also, no noticeable difference can be seen between the two convergence criteria considered.
Regarding the CPU time expended to reach an error of \num{1e-5}, presented in Figure~\ref{subfig:linear_3D_normal_comparison_crit_cpu_time_vs_n_voxels}, Criterion I leads to faster convergence.
This effect is stronger for the FFT Basic scheme.

\begin{figure}[hbt] % fig:linear_3D_normal_comparison_crit
  \centering
	\begin{subfigure}[b]{0.52\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_3D_normal_comparison_crit_homo_stress_11_vs_n_voxels}
    \caption{}
    \label{subfig:linear_3D_normal_comparison_crit_homo_stress_11_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{0.46\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_3D_normal_comparison_crit_cpu_time_vs_n_voxels}
    \caption{}
    \label{subfig:linear_3D_normal_comparison_crit_cpu_time_vs_n_voxels}
  \end{subfigure}
  \caption{Comparison between the Criterion I and II for FFT-based homogenization
  approaches, Galerkin and Basic, in the solution of the particle-reinforced linear elastic
  composite equilibrium problem under uniaxial strain loading conditions:
  \subref{subfig:linear_3D_normal_comparison_crit_homo_stress_11_vs_n_voxels} Homogenized
  stress; \subref{subfig:linear_3D_normal_comparison_crit_cpu_time_vs_n_voxels}
  Computational time.} \label{fig:linear_3D_normal_comparison_crit}
\end{figure}

From these results a few conclusions can be gathered:
\begin{itemize}
  \item Both of the convergence criteria considered for the FFT-Galerkin method are accurate;
  \item Criterion II is markedly faster than Criterion I, without compromising accuracy.
\end{itemize}

\FloatBarrier

\paragraph{Accuracy validation}
Both phases are assumed linear elastic (see Table~\ref{tab:mat_properties} for the properties), periodic boundary conditions are adopted and the following two macroscale strain loading cases are considered
\begin{equation}
\text { uniaxial: } \bm{\varepsilon}=\left[\begin{array}{lll}
5 & 0 & 0 \\
0 & 0 & 0 \\
0 & 0 & 0
\end{array}\right] \times 10^{-3}, \quad \text { pure shear: } \quad \bm \varepsilon=\left[\begin{array}{ccc}
0 & 5 & 5 \\
5 & 0 & 5 \\
5 & 5 & 0
\end{array}\right] \times 10^{-3},
\end{equation}
being enforced in a single load increment.
Note that in the 2D plane strain case, only the inplane \(O_{x y}\) macroscale strain components are enforced.
The convergence criterion used is Criterion II, as described in Section~\ref{sec:criteria}.

The numerical results of the fiber-reinforced linear elastic composite equilibrium problem are shown in Figures~\ref{fig:linear_2D_normal} and \ref{fig:linear_2D_shear} for the uniaxial and pure shear loading cases, respectively.
In both cases there is an excellent agreement between the FFT and FEM-based homogenization solutions concerning both the homogenized response (see Figures~\ref{subfig:linear_2D_normal_homo_stress_11_vs_n_voxels} and \ref{subfig:linear_2D_shear_homo_stress_12_vs_n_voxels}) and the local strain fields (see Figures \ref{subfig:linear_2D_normal_strain_11} and \ref{subfig:linear_2D_shear_strain_12}).
In terms of computational performance, Figures~\ref{subfig:linear_2D_normal_cpu_time_vs_n_voxels} and \ref{subfig:linear_2D_shear_cpu_time_vs_n_voxels} show that the FFT-based homogenization Galerkin scheme outperforms the FEM-based homogenization with speedups of around 2 relative to the direct solver with quadratic finite elements.
There is however a caveat, regarding this direct comparison.
The Python libraries used in the implementation of the FFT-based homogenization Galerkin scheme are parallelized and use all the cores available in the machine.
On the other hand, the FEM simulations are run using only one core.
When compared with the FFT-based homogenization basic scheme, the CPU time expended differs by more than an order of magnitude, with the Galerkin scheme being slower.

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_2D_normal_homo_stress_11_vs_n_voxels}
    \caption{}
    \label{subfig:linear_2D_normal_homo_stress_11_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_2D_normal_cpu_time_vs_n_voxels}
    \caption{}
    \label{subfig:linear_2D_normal_cpu_time_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_2D_normal_strain_11}
    \caption{}
    \label{subfig:linear_2D_normal_strain_11}
  \end{subfigure}
  \caption{Comparison between the FFT and FEM-based homogenization approaches in the
  solution of the fiber-reinforced linear elastic composite equilibrium problem under pure
  shear strain loading conditions:
  \subref{subfig:linear_2D_normal_homo_stress_11_vs_n_voxels} Homogenized stress;
  \subref{subfig:linear_2D_normal_cpu_time_vs_n_voxels} Computational time;
  \subref{subfig:linear_2D_normal_strain_11} Local strain field (\(n_v = 600 \times 600\)
  discretization). Notation: linear element (L), quadratic element (Q), direct solver (DS)
  and iterative solver (IS)}
\label{fig:linear_2D_normal}
\end{figure}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_2D_shear_homo_stress_12_vs_n_voxels}
    \caption{}
    \label{subfig:linear_2D_shear_homo_stress_12_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_2D_shear_cpu_time_vs_n_voxels}
    \caption{}
    \label{subfig:linear_2D_shear_cpu_time_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_2D_shear_strain_12}
    \caption{}
    \label{subfig:linear_2D_shear_strain_12}
  \end{subfigure}
  \caption{Comparison between the FFT and FEM-based homogenization approaches in the
  solution of the fiber-reinforced linear elastic composite equilibrium problem under pure
  shear strain loading conditions:
  \subref{subfig:linear_2D_normal_homo_stress_11_vs_n_voxels} Homogenized stress;
  \subref{subfig:linear_2D_normal_cpu_time_vs_n_voxels} Computational time;
  \subref{subfig:linear_2D_normal_strain_11} Local strain field (\(n_v = 600 \times 600\)
  discretization). Notation: linear element (L), quadratic element (Q), direct solver (DS)
  and iterative solver (IS)}
\label{fig:linear_2D_shear}
\end{figure}

The numerical results of the particle-reinforced linear elastic composite equilibrium problem are shown in Figures~\ref{fig:linear_3D_normal} and \ref{fig:linear_3D_shear} for the uniaxial and pure shear loading cases, respectively.
Once again there is an excellent agreement between the FFT and FEM-based homogenization solutions concerning both the homogenized response (see Figures \ref{subfig:linear_3D_normal_homo_stress_11_vs_n_voxels} and \ref{subfig:linear_3D_shear_homo_stress_12_vs_n_voxels} and the local strain fields (see Figures~\ref{subfig:linear_3D_normal_strain_11} and \ref{subfig:linear_3D_shear_strain_12}.
In terms of computational performance, Figures~\ref{subfig:linear_3D_normal_cpu_time_vs_n_voxels} and \ref{subfig:linear_3D_shear_cpu_time_vs_n_voxels} show that the FFT-based homogenization Galerkin scheme outperforms the FEM-based homogenization with speedups ranging from around 10 and 100 relative to the iterative solver with linear and quadratic finite elements, respectively.
The same remark concerning the number of cores used in each method mentioned previously also applies here.
Comparing the two FFT-based schemes, the basic scheme is faster by an order of magnitude than the Galerkin scheme.
Adding to this, the 3D cases highlight another important aspect concerning FEM-based homogenization. When attempting to run the direct solver simulations with \(n_{e}=80 \times 80 \times 80\) (linear finite element mesh) and \(n_{e}=50 \times 50 \times 50\) (quadratic finite element mesh) the memory required to build the global tangent stiffness matrix (stored in compressed sparse row (CSR) format) exceeds the available 128 GB!
Despite reaching a significantly lower peak memory than the direct solver, the iterative solver suffered from the same limitation for a simulation over \(n_{e}=100 \times 100 \times 100\) (linear finite element mesh) and \(n_{e}=70 \times 70 \times 70\) (quadratic finite element mesh).
In comparison, the FFT-based homogenization memory footprint is almost negligible as it does not require the computation of a global tangent stiffness matrix.

\begin{figure}[hbt] % fig:linear_3D_normal
  \centering
	\begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_3D_normal_homo_stress_11_vs_n_voxels}
    \caption{}
    \label{subfig:linear_3D_normal_homo_stress_11_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_3D_normal_cpu_time_vs_n_voxels}
    \caption{}
    \label{subfig:linear_3D_normal_cpu_time_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_3D_normal_strain_11}
    \caption{}
    \label{subfig:linear_3D_normal_strain_11}
  \end{subfigure}
  \caption{Comparison between the FFT and FEM-based homogenization approaches in the
  solution of the particle-reinforced linear elastic composite equilibrium problem under normal
  strain loading conditions: \subref{subfig:linear_3D_normal_homo_stress_11_vs_n_voxels} Homogenized stress; \subref{subfig:linear_3D_normal_cpu_time_vs_n_voxels} Computational time; \subref{subfig:linear_3D_normal_strain_11} Local strain field
  (\(n_v = 70 \times 70\times 70\) discretization). Notation: linear element (L), quadratic element (Q), direct solver
  (DS) and iterative solver (IS)}
\label{fig:linear_3D_normal}
\end{figure}

\begin{figure}[hbt] % fig:linear_3D_shear
  \centering
	\begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_3D_shear_homo_stress_12_vs_n_voxels}
    \caption{}
    \label{subfig:linear_3D_shear_homo_stress_12_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_3D_shear_cpu_time_vs_n_voxels}
    \caption{}
    \label{subfig:linear_3D_shear_cpu_time_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_3D_shear_strain_12}
    \caption{}
    \label{subfig:linear_3D_shear_strain_12}
  \end{subfigure}
  \caption{Comparison between the FFT and FEM-based homogenization approaches in the
  solution of the fiber-reinforced linear elastic composite equilibrium problem under pure shear
  strain loading conditions: \subref{subfig:linear_3D_shear_homo_stress_12_vs_n_voxels} Homogenized stress; \subref{subfig:linear_3D_normal_cpu_time_vs_n_voxels} Computational time; \subref{subfig:linear_3D_normal_strain_11} Local strain field
  (\(n_v = 70 \times 70 \times 70\) discretization). Notation: linear element (L), quadratic element (Q), direct solver
  (DS) and iterative solver (IS).}
\label{fig:linear_3D_shear}
\end{figure}

From the results present, a few conclusions and remarks are in order:
\begin{itemize}
  \item The FFT-based homogenization Galerkin scheme implementation is validated as solutions obtained (both homogenized results and local fields) are in excellent agreement with ones obtained with the FEM-based homogenization from LINKS and the FFT-based homogenization basic scheme;
  \item In the linear elastic regime, the FFT-based homogenization Galerkin scheme outperforms the FEM-based homogenization both in terms of speed and memory footprint.
  However, it must be kept in mind that some of the Python libraries employed in the implementation of the FFT-based homogenization Galerkin scheme are parallelized and only one core is used in the LINKS simulations.
  \item In the linear elastic regime, the FFT-based homogenization basic scheme outperforms the FFT-based homogenization Galerkin scheme in terms of CPU time expended.
  Yet, consider that the implementation of the basic scheme used in the comparison \cite{} has already undergone some performance optimization.
  This is not the case for the Galerkin scheme.
  \item Given the solution convergence with the increasing sampling/meshing refinement, the spatial discretizations of \(n_{v}=600 \times 600\) (fiber-reinforced composite 2D RVE) and \(n_{v}=70 \times\) \(70 \times 70\) (particle-reinforced composite 3D RVE) are considered hereafter unless otherwise stated;
\end{itemize}

\FloatBarrier

\paragraph{Extreme stiffness ratios between phases}

The following set of results is presented to better comprehend the limitations of the FFT-based methods regarding the stiffness ratio between the phases, widely reported in the literature \citep{ma_numerical_2021}.
As previously, FEM solutions are used as a comparison standard.

Both phases are assumed linear elastic having the same Poisson's ratio, \(\nu=0.3\).
The Young modulus of the matrix is fixed at \(E_1=\SI{100}{\mega\pascal}\) and the ratio between the stiffness of the particles and the matrix, \(K=E_1/E_2\), is made to vary from \num{e-6} to \num{e4} in increments of \(\times \sqrt{10}\).
Hence forth, by positive contrast it is meant that \(K>1\) and negative contrast \(K<1\).
Periodic boundary conditions are adopted and the following macroscale strain loading case is considered
\begin{equation}
\text { uniaxial: } \bm{\varepsilon}=\left[\begin{array}{lll}
5 & 0 & 0 \\
0 & 0 & 0 \\
0 & 0 & 0
\end{array}\right] \times 10^{-3},
\end{equation}
being enforced in a single load increment.
Note that in the 2D plane strain case, only the inplane \(O_{x y}\) macroscale strain components are enforced.

The numerical results of the fiber-reinforced linear elastic composite equilibrium problem are shown in Figures~\ref{fig:linear_2D_normal_stiff_contrast} for the uniaxial loading case.
There is an excellent agreement between the FFT and FEM-based homogenization solutions concerning the homogenized response as attested by Figure~\ref{subfig:linear_2D_normal_stress_avg_vs_stiff_ratio}.
In terms of computational performance, Figure~\ref{subfig:linear_2D_normal_stress_avg_cpu_time_vs_n_voxels} shows that the FFT-Galerkin-based homogenization scheme outperforms the FEM-based homogenization with speedups from around 20 at low stiffness contrast to around 2 at the highest stiffness contrasts, both positive and negative, relative to the direct solver with quadratic finite elements.
As before, the caveat regarding the parallelization of the Python libraries still applies.
When compared with the FFT-based homogenization basic scheme, the CPU time expended differs from one to two orders of magnitude across the stiffness ranges considered, with the Galerkin scheme being slower.
However, the basic scheme is unable to reach the preset tolerance \((\num{e-6})\) for stiffness ratios beyond the range \([\num{e-3},\num{e3}]\).

Concerning the local field, an excellent agreement can be observed at high constrasts, both positive \((K=E_1/E_2=\num{e4})\) and negative \((K=E_1/E_2=\num{e-4})\) stiffness ratios in the matrix phase, as can be seen in Figures~\ref{fig:linear_2D_stiff_contrast_normal_strain_11} and \ref{fig:linear_2D_stiff_contrast_normal_stress_11}.
There is also good agreement regarding the local field in the particle phase for the strain field when there is a strongly negative stiffness ratio and the stress field when there is a strongly positive stiffness ratio.
On the other hand, the strain field at the strongly negative stiffness ratio and the strain field at the strongly positive stiffness ratio exhibit strong oscillations in the particle phase.
Figure~\ref{fig:linear_2D_ratio_-4_normal_strain_11_particles} provides a more detailed representation of the variation of the strain field \(\varepsilon_{\mu,xx}\) inside the particle pahse at a stiffness ratio equal to \num{e-4}.
This phenomenon is often denominated by "ringing" and is widely reported in the literature as being a consequence of very pronounced stiffness ratios between the phases.
The extreme values found in Figure~\ref{subfig:linear_2D_ratio_-4_normal_strain_11_particle_1} concerning the FFT Galerkin method for the local normal strain field, \(\varepsilon_{\mu,xx}\), at \(y=0\) and \(0\leq x\leq 0.2\), are not dissimilar to the extreme values present in FEM solution (see Figure~\ref{subfig:linear_2D_ratio_-4_normal_strain_11}).
However, looking at Figure~\ref{subfig:linear_2D_ratio_-4_normal_strain_11_particle_2}, the extreme values of the local field at at \(y=0\) and \(0.45 \leq x\leq 0.55\) are now one order of magnitude larger than the ones in the FEM solution.
This presents a clear error in the FFT-Galerkin solution for the local strain field inside the particles.
The FFT-based basic scheme homogenization also presents this fragility.
In closing, it bears mentioning that this does not affect the accuracy of the homogenized response.


\begin{figure}[hbt]
  \centering
  	\begin{subfigure}[b]{0.49\textwidth}
      \centering
      \includegraphics[width=\textwidth]{figures/linear_2D_normal_stress_avg_vs_stiff_ratio}
      \caption{}
      \label{subfig:linear_2D_normal_stress_avg_vs_stiff_ratio}
    \end{subfigure}
    \begin{subfigure}[b]{0.49\textwidth}
      \centering
      \includegraphics[width=\textwidth]{figures/linear_2D_normal_stress_avg_cpu_time_vs_n_voxels}
      \caption{}
      \label{subfig:linear_2D_normal_stress_avg_cpu_time_vs_n_voxels}
    \end{subfigure}
  \caption{Comparison between the FFT and FEM-based homogenization approaches in the solution
  of the fiber-reinforced linear elastic composite equilibrium problem under normal strain
  loading conditions: \subref{subfig:linear_2D_normal_stress_avg_vs_stiff_ratio} Homogenized
  stress; \subref{subfig:linear_2D_normal_stress_avg_cpu_time_vs_n_voxels} Computational time;
  Notation: linear element (L), quadratic element (Q).}
\label{fig:linear_2D_normal_stiff_contrast}
\end{figure}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_2D_ratio_-4_normal_strain_11}
    \caption{}
    \label{subfig:linear_2D_ratio_-4_normal_strain_11}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_2D_ratio_4_normal_strain_11}
    \caption{}
    \label{subfig:linear_2D_ratio_4_normal_strain_11}
  \end{subfigure}
  \caption{Comparison between the local strain field \(\varepsilon_{\mu,xx}\) obtained using
  FFT and FEM-based homogenization approaches in the solution of the fiber-reinforced
  linear elastic composite equilibrium problem under normal strain loading conditions:
  \subref{subfig:linear_2D_ratio_-4_normal_strain_11} Stiffness ratio \(K=E_1/E_2=\num{e-4}\);
  \subref{subfig:linear_2D_ratio_4_normal_strain_11} Stiffness ratio \(K=E_1/E_2=\num{e1.5}\);
  Notation: quadratic element (Q).}
\label{fig:linear_2D_stiff_contrast_normal_strain_11}
\end{figure}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_2D_ratio_-4_normal_stress_11}
    \caption{}
    \label{subfig:linear_2D_ratio_4_normal_stress_11}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_2D_ratio_4_normal_stress_11}
    \caption{}
    \label{subfig:linear_2D_ratio_-4_normal_stress_11}
  \end{subfigure}
  \caption{Comparison between the local stress field \(\sigma_{\mu,xx}\) obtained using
  FFT and FEM-based homogenization approaches in the solution of the fiber-reinforced
  linear elastic composite equilibrium problem under normal strain loading conditions:
  \subref{subfig:linear_2D_ratio_-4_normal_stress_11} Stiffness ratio \(K=E_1/E_2=\num{e-4}\);
  \subref{subfig:linear_2D_ratio_4_normal_stress_11} Stiffness ratio \(K=E_1/E_2=\num{e1.5}\);
  Notation: quadratic element (Q).}
\label{fig:linear_2D_stiff_contrast_normal_stress_11}
\end{figure}

\begin{figure}[hbt]
  \centering
  	\begin{subfigure}[b]{0.49\textwidth}
      \centering
      \includegraphics[width=\textwidth]{figures/linear_2D_ratio_-4_normal_strain_11_particle_1}
      \caption{}
      \label{subfig:linear_2D_ratio_-4_normal_strain_11_particle_1}
    \end{subfigure}
    \begin{subfigure}[b]{0.49\textwidth}
      \centering
      \includegraphics[width=\textwidth]{figures/linear_2D_ratio_-4_normal_strain_11_particle_2}
      \caption{}
      \label{subfig:linear_2D_ratio_-4_normal_strain_11_particle_2}
    \end{subfigure}
  \caption{Normal microscopic strain, \(\varepsilon_{\mu,xx}\), at \(y=0\) under a normal loading scheme as a function of the \(x\) coordinate for the fiber-reinforced linear elastic composite. The stiffness ratio between the matrix phase and the particle phase is \(K=E_1/E_2=\num{e-4}\).}
\label{fig:linear_2D_ratio_-4_normal_strain_11_particles}
\end{figure}

The numerical results of the particle-reinforced linear elastic composite equilibrium problem are shown in Figures~\ref{fig:linear_3D_normal_stiff_contrast} for the uniaxial loading case.
There is an excellent agreement between the FFT-based homogenization Galerkin scheme and the FEM-based homogenization solutions concerning the homogenized response as attested by Figure~\ref{subfig:linear_3D_normal_stress_avg_vs_stiff_ratio}.
The same cannot be said for the FFT-based homogenization Galerkin scheme as the stiffness ratio becomes more extreme.
In terms of computational performance, Figure~\ref{subfig:linear_3D_normal_stress_avg_cpu_time_vs_n_voxels} shows that the FFT-based homogenization Galerkin scheme outperforms the FEM-based homogenization with speedups from around 100 at minor stiffness contrast to around 3 at the lowest stiffness contrast, relative to the direct solver with quadratic finite elements.
As before, the caveat regarding the parallelization of the Python libraries still applies.
When compared with the FFT-based homogenization basic scheme, the CPU time expended differs from one to two orders of magnitude across the stiffness ranges considered, with the Galerkin scheme being slower.
It must be added that for higher stiffness ratios the WSMP-SSOR solver is not able to converge.

Concerning the local field, an excellent agreement can be observed at both high \((K=E_1/E_2=10^{1.5})\) and low \((K=E_1/E_2=\num{e-4})\) stiffness ratios in the matrix phase, as can be seen in Figures~\ref{fig:linear_3D_stiff_contrast_normal_strain_11} and \ref{fig:linear_3D_stiff_contrast_normal_stress_11}.
There is also good agreement regarding the local field in the particle phase for the strain field at the low stiffness ratio and the stress field at the high stiffness ratio.
On the other hand, the strain field at the low stiffness ratio and the strain field at the high stiffness ratio exhibit strong oscillations in the particle phase.
This mirrors the previous results concerning two-dimensional microstructures.

From these results, it follows regarding the FFT-Gakerin method that:
\begin{itemize}
  \item For the two-dimensional microstructure, the homogenized solutions found using both of the FFT-based approaches are accurate, matching the solutions found using FEM.
  \item The FFT-Galerkin method converges for all the stiffness constrasts considered \((\num{e-6} \leq K \leq \num{e4})\), in constrast with the FFT-basic scheme which failed for more demanding sitffness constrasts (\(K<\num{e-3}\) and \(K>\num{e2.5}\)).
  \item For the three-dimensional microstructure, the homogenized solutions, as well as, the local fields, found using the FFT-Galerkin approach is accurate, matching the solutions found using FEM.
  \item For the three-dimensional microstructure, the homogenized solutions found using the FFT-basic approach are not accurate for more demanding stiffness contrasts (\(K<\num{e-1}\) and \(K>\num{e1}\)).
  \item For both microstructures, the local fields inside the fibers/particles obtained using both of the FFT-based approaches are not accurate for more demanding stiffness contrast, as strong oscillations whose extreme values are large when compared with the FEM solution can be found.
  \item Regarding computational efficiency, the FFT-basic scheme is by far the fastest of the methods considered.
  The FFT-Galerkin scheme is faster than the FEM, in particular in three dimensions.
  This time improvement lessens as the stiffness contrast strengthens.
\end{itemize}

\begin{figure}[hbt]
  \centering
  	\begin{subfigure}[b]{0.49\textwidth}
      \centering
      \includegraphics[width=\textwidth]{figures/linear_3D_normal_stress_avg_vs_stiff_ratio}
      \caption{}
      \label{subfig:linear_3D_normal_stress_avg_vs_stiff_ratio}
    \end{subfigure}
    \begin{subfigure}[b]{0.49\textwidth}
      \centering
      \includegraphics[width=\textwidth]{figures/linear_3D_normal_stress_avg_cpu_time_vs_n_voxels}
      \caption{}
      \label{subfig:linear_3D_normal_stress_avg_cpu_time_vs_n_voxels}
    \end{subfigure}
  \caption{Comparison between the FFT and FEM-based homogenization approaches in the solution
  of the particle-reinforced linear elastic composite equilibrium problem under normal strain
  loading conditions: \subref{subfig:linear_3D_normal_stress_avg_vs_stiff_ratio} Homogenized
  stress; \subref{subfig:linear_3D_normal_stress_avg_cpu_time_vs_n_voxels} Computational time;
  Notation: linear element (L), quadratic element (Q).}
\label{fig:linear_3D_normal_stiff_contrast}
\end{figure}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_3D_ratio_-4_normal_strain_11}
    \caption{}
    \label{subfig:linear_3D_ratio_-4_normal_strain_11}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_3D_ratio_1_5_normal_strain_11}
    \caption{}
    \label{subfig:linear_3D_ratio_1_5_normal_strain_11}
  \end{subfigure}
  \caption{Comparison between the local strain field \(\varepsilon_{\mu,xx}\) obtained using
  FFT and FEM-based homogenization approaches in the solution of the particle-reinforced
  linear elastic composite equilibrium problem under normal strain loading conditions:
  \subref{subfig:linear_3D_ratio_-4_normal_strain_11} Stiffness ratio \(K=E_1/E_2=\num{e-4}\);
  \subref{subfig:linear_3D_ratio_1_5_normal_strain_11} Stiffness ratio \(K=E_1/E_2=\num{e1.5}\);
  Notation: quadratic element (Q).}
\label{fig:linear_3D_stiff_contrast_normal_strain_11}
\end{figure}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_3D_ratio_-4_normal_stress_11}
    \caption{}
    \label{subfig:linear_3D_ratio_1_5_normal_stress_11}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/linear_3D_ratio_1_5_normal_stress_11}
    \caption{}
    \label{subfig:linear_3D_ratio_-4_normal_stress_11}
  \end{subfigure}
  \caption{Comparison between the local stress field \(\sigma_{\mu,xx}\) obtained using
  FFT and FEM-based homogenization approaches in the solution of the particle-reinforced
  linear elastic composite equilibrium problem under normal strain loading conditions:
  \subref{subfig:linear_3D_ratio_-4_normal_stress_11} Stiffness ratio \(K=E_1/E_2=\num{e-4}\);
  \subref{subfig:linear_3D_ratio_1_5_normal_stress_11} Stiffness ratio \(K=E_1/E_2=\num{e1.5}\);
  Notation: quadratic element (Q).}
\label{fig:linear_3D_stiff_contrast_normal_stress_11}
\end{figure}


\FloatBarrier

\subsection{Large strain}

The following results concern large strains with materials being modeled either by the Henkcy constitutive model or the Saint Venant-Kirchhoff constitutive model.

\paragraph{Mesh convergency studies}

A few mesh convergency studies are presented in what follows.
Both phases are assumed to follow either the Hencky constitutive model or the Saint Venant-Kirchhoff model (see Table~\ref{tab:mat_properties} for the properties), periodic boundary conditions are adopted and the following two macroscale strain loading cases are considered
\begin{equation}
\text { uniaxial: } \bm{F}=\left[\begin{array}{ll}
1.1 & 0 \\
0 & 1  \\
\end{array}\right], \quad \text { pure shear: } \quad \bm F=\left[\begin{array}{cc}
1 & 0.3 \\
0 & 1  \\
\end{array}\right],
\end{equation}
being enforced in a single load increment.
Only the 2D microstructure is considered due to time and memory constraints.

\subparagraph{Hencky}

The numerical results of the fiber-reinforced Hencky hyperelastic composite equilibrium problem are shown in Figures~\ref{fig:hencky_2D_normal} and \ref{fig:hencky_2D_shear} for the uniaxial and pure shear loading cases, respectively.
In both cases the finest mesh used fails to achieve convergence and there is still some disagreement between the FFT and FEM-based homogenization solutions regarding the homogenized response (see Figures~\ref{subfig:hencky_2D_normal_homo_stress_11_vs_n_voxels} and \ref{subfig:hencky_2D_shear_homo_stress_12_vs_n_voxels}).
In what concerns the local strain fields (see Figures \ref{subfig:hencky_2D_normal_strain_11} and \ref{subfig:hencky_2D_shear_strain_12}), visually, there seems to be a good agreement between the two approaches.
In terms of computational performance, Figures~\ref{subfig:hencky_2D_normal_cpu_time_vs_n_voxels} and \ref{subfig:hencky_2D_shear_cpu_time_vs_n_voxels} show that the FFT-based homogenization Galerkin scheme outperforms the FEM-based homogenization with speedups of around 2 relative to the direct solver with linear quadratic elements.
However, the caveat regarding parallelization still applies.

From these results, it follows regarding the application of the FFT-Gakerin method to the Hencky constitutive model that:
\begin{itemize}
  \item A discretization of \(n_v=800\times 800\) is not enough to achieve convergence between the FFT-Galerkin and FEM homogenized solutions when using the Hencky constitutive model;
  \item The local strain fields obtained by the FFT-Galerkin method and the FEM agree visually.
\end{itemize}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_2D_normal_homo_stress_11_vs_n_voxels}
    \caption{}
    \label{subfig:hencky_2D_normal_homo_stress_11_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_2D_normal_cpu_time_vs_n_voxels}
    \caption{}
    \label{subfig:hencky_2D_normal_cpu_time_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_2D_normal_strain_11}
    \caption{}
    \label{subfig:hencky_2D_normal_strain_11}
  \end{subfigure}
  \caption{Comparison between the FFT (Criterion I and II) and FEM-based homogenization approaches in the
  solution of the fiber-reinforced hyperelastic (Hencky constitutive model) composite equilibrium problem under uniaxial strain loading conditions:
  \subref{subfig:hencky_2D_normal_homo_stress_11_vs_n_voxels} Homogenized stress;
  \subref{subfig:hencky_2D_normal_cpu_time_vs_n_voxels} Computational time;
  \subref{subfig:hencky_2D_normal_strain_11} Local strain field (\(n_v = 600 \times 600\)
  discretization). Notation: quadratic element (Q)}
\label{fig:hencky_2D_normal}
\end{figure}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_2D_shear_homo_stress_12_vs_n_voxels}
    \caption{}
    \label{subfig:hencky_2D_shear_homo_stress_12_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_2D_shear_cpu_time_vs_n_voxels}
    \caption{}
    \label{subfig:hencky_2D_shear_cpu_time_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_2D_shear_strain_12}
    \caption{}
    \label{subfig:hencky_2D_shear_strain_12}
  \end{subfigure}
  \caption{Comparison between the FFT (Criterion I and II) and FEM-based homogenization approaches in the
  solution of the fiber-reinforced hyperelastic (Hencky constitutive model) composite equilibrium problem under pure
  shear strain loading conditions:
  \subref{subfig:hencky_2D_shear_homo_stress_12_vs_n_voxels} Homogenized stress;
  \subref{subfig:hencky_2D_shear_cpu_time_vs_n_voxels} Computational time;
  \subref{subfig:hencky_2D_shear_strain_12} Local strain field (\(n_v = 600 \times 600\)
  discretization). Notation: quadratic element (Q)}
\label{fig:hencky_2D_shear}
\end{figure}

\FloatBarrier

\subparagraph{Saint Venant-Kirchhoff model}

The numerical results of the fiber-reinforced Saint Venant-Kirchhoff hyperelastic composite equilibrium problem are shown in Figure~\ref{fig:svk_2D_normal} for the uniaxial loading case.
Neither the FFT-based nor the FEM-based homogenization procedures can solve the equilibrium problem for the pure shear loading cases when the load is enforced in a single increment, as such these results are not presented.
There is an excellent agreement between the FFT and FEM-based homogenization solutions concerning both the homogenized response (see Figure~\ref{subfig:svk_2D_normal_homo_stress_11_vs_n_voxels}) and the local strain fields (see Figure~\ref{subfig:svk_2D_normal_strain_11}).
In terms of computational performance, Figure~\ref{subfig:svk_2D_normal_cpu_time_vs_n_voxels} shows that the FFT-based homogenization Galerkin scheme outperforms the FEM-based homogenization with speedups of around 2 to 10 relative to the direct solver with quadratic finite elements as the number of voxels increases.
The caveat previously mentioned regarding the parallelization of both schemes still applies.
Comparing the convergence criteria for the FFT schemes, Criterion I remains the most efficient without compromising accuracy.

From these results, it follows regarding the application of the FFT-Gakerin method to the Saint-Venant constitutive model that:
\begin{itemize}
  \item A discretization of \(n_v=600\times 600\) is enough to achieve convergence between the FFT-Galerkin and FEM homogenized solutions when using the Saint Venant-Kirchhoff constitutive model;
  \item The local strain fields obtained by the FFT-Galerkin method and the FEM agree visually.
\end{itemize}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/svk_2D_normal_homo_stress_11_vs_n_voxels}
    \caption{}
    \label{subfig:svk_2D_normal_homo_stress_11_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/svk_2D_normal_cpu_time_vs_n_voxels}
    \caption{}
    \label{subfig:svk_2D_normal_cpu_time_vs_n_voxels}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/svk_2D_normal_strain_11}
    \caption{}
    \label{subfig:svk_2D_normal_strain_11}
  \end{subfigure}
  \caption{Comparison between the FFT (Criterion I and II) and FEM-based homogenization approaches in the
  solution of the fiber-reinforced hyperelastic (Saint Venant-Kirchhoff constitutive model) composite equilibrium problem under uniaxial strain loading conditions:
  \subref{subfig:svk_2D_normal_homo_stress_11_vs_n_voxels} Homogenized stress;
  \subref{subfig:svk_2D_normal_cpu_time_vs_n_voxels} Computational time;
  \subref{subfig:svk_2D_normal_strain_11} Local strain field (\(n_v = 600 \times 600\)
  discretization). Notation: quadratic element (Q)}
\label{fig:svk_2D_normal}
\end{figure}

\FloatBarrier

\paragraph{Accuracy validation}

Both phases are assumed to follow either the Hencky constitutive model or the Saint Venant-Kirchhoff model (see Table~\ref{tab:mat_properties} for the properties), periodic boundary conditions are adopted and the following two macroscale strain loading cases are considered
\begin{equation}
\text { uniaxial: } \bm{F}=\left[\begin{array}{ccc}
1.3 & 0 & 0 \\
0 & 1 & 0  \\
0 & 0 & 1  \\
\end{array}\right], \quad \text { pure shear: } \quad \bm F=\left[\begin{array}{ccc}
1 & 0.3 & 0 \\
0 & 1 & 0  \\
0 & 0 & 1  \\
\end{array}\right],
\end{equation}
being enforced in 200 load increments.
The convergence criterion used for the FFT Galerkin method scheme is Criterion II (see Section~\ref{sec:criteria}).
Both schemes (FFT and FEM) use all the cores available in the machine.
% Only the 2D microstructure is considered due to time and memory constraints.
The meshes used are \(n_e=600\times 600\) and \(n_e = 70\times70\times\) for both models, even though for the Henkcy constitutive model convergence with the FEM solution is not achieved.
Due to time constraints in three dimensions, only the uniaxial strain loading scheme is available.

\subparagraph{Hencky}
\label{sec:hencky_accuracy_validation}

The numerical results of the fiber-reinforced composite equilibrium problem are shown in Figures~\ref{fig:hencky_mat_res_2D_normal} and \ref{fig:hencky_mat_res_2D_shear} for the uniaxial and pure shear loading cases, respectively.
For the particle-reinforced composite equilibrium, the results are shown in Figure~\ref{fig:hencky_mat_res_3D_normal} for the uniaxial loading case.

In all cases there is an excellent agreement between the FFT and FEM-based homogenization solutions concerning both the homogenized response (see Figures~\ref{subfig:hencky_2D_normal_material_response}, \ref{subfig:hencky_2D_normal_material_response_error}, \ref{subfig:hencky_2D_shear_material_response}, \ref{subfig:hencky_2D_shear_material_response_error}, \ref{subfig:hencky_3D_normal_material_response} and \ref{subfig:hencky_3D_normal_material_response_error} and the local strain fields (see Figures \ref{subfig:hencky_2D_normal_strain_11}, \ref{subfig:hencky_2D_shear_strain_12} and \ref{subfig:hencky_2D_normal_strain_11}).
Moreover, the relative error of the FFT solutions when compared with the FEM solutions is very low.
In two dimensions, under 0.1\% for the uniaxial load and under 0.015\% for the pure shear load.
In three dimensions, for the uniaxial load, it is always under 0.5\%.
However, it must be kept in mind that the enforced deformation is not very large as can be seen from the relatively small deviation of the material response from linear behavior.
The deformation values are conservative for a hyperelastic material because the FEM solutions fail to converge for more demanding values with 200 load increments.
The FFT-based Galerkin method homogenization scheme can obtain the correct solution for uniaxial strains \(F_{xx}\) as high as 1.5 in a single load increment.
This is found from numerical experience using a coarser mesh and more than 200 increments.

In terms of computational performance, Table~\ref{tab:hencky_2D_cpu_time} shows that FFT and FEM approaches for the two-dimensional microstructure take about the same CPU time for both loading schemes, i.e, around three hours and twenty minutes.
Table~\ref{tab:hencky_normal_2D_time_profile} shows the time profile for the FFT-based homogenization approach in the solution of the fiber-reinforced hyperelastic (Hencky constitutive model) composite equilibrium problem under uniaxial strain loading conditions (\(n_v=600\times 600\)).
The phase of the solution procedure that takes the majority of the time is the state update (\(\approx 92\%)\).
The application of the projection operator, repeated during the solution using the conjugate gradient method takes only \(\approx 6\%\) of the time.
On the other hand, for the three-dimensional microstructure, a massive improvement is observed, with the FFT-Galerkin method taking around 25 times less than the FEM, as shows Table~\ref{tab:hencky_3D_cpu_time}.
It is not entirely clear why this marked improvement when going from two to three dimensions.

This is set of results lead to the following conclusions:
\begin{itemize}
  \item There is good agreement between the FFT-Galerkin and FEM solutions (homogenized response and local strain fields);
  \item The efficiency of both methods is about the same in two dimensions for both strain loading schemes considered.
  \item The FFT-Galerkin method is markedly more efficient than the FEM for the three-dimensional microstructure subject to a uniaxial strain loading scheme.
\end{itemize}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_2D_normal_material_response}
    \caption{}
    \label{subfig:hencky_2D_normal_material_response}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_2D_normal_material_response_error}
    \caption{}
    \label{subfig:hencky_2D_normal_material_response_error}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_2D_normal_strain_11}
    \caption{}
    \label{subfig:hencky_2D_normal_strain_11}
  \end{subfigure}
  \caption{Comparison between the FFT-based and FEM-based homogenization approaches in the
  solution of the fiber-reinforced hyperelastic (Hencky constitutive model) composite equilibrium problem under uniaxial
  strain loading conditions: \subref{subfig:hencky_2D_normal_homo_stress_11_vs_n_voxels} Homogenized material response; \subref{subfig:hencky_2D_normal_material_response_error} Relative error of the homogenized material response obtained with the FFT approach relative to the FEM approach; \subref{subfig:hencky_2D_normal_strain_11} Local strain field at full load (\(n_v = 600 \times 600\)
  discretization). Notation: quadratic element (Q).}
\label{fig:hencky_mat_res_2D_normal}
\end{figure}

\begin{figure}[hbt]
    \centering
  	\begin{subfigure}[b]{0.49\textwidth}
      \centering
      \includegraphics[width=\textwidth]{figures/hencky_2D_shear_material_response}
      \caption{}
      \label{subfig:hencky_2D_shear_material_response}
    \end{subfigure}
    \begin{subfigure}[b]{0.49\textwidth}
      \centering
      \includegraphics[width=\textwidth]{figures/hencky_2D_shear_material_response_error}
      \caption{}
      \label{subfig:hencky_2D_shear_material_response_error}
    \end{subfigure}
    \begin{subfigure}[b]{\textwidth}
      \centering
      \includegraphics[width=\textwidth]{figures/hencky_2D_shear_strain_12}
      \caption{}
      \label{subfig:hencky_2D_shear_strain_12}
    \end{subfigure}
    \caption{Comparison between the FFT-based and FEM-based homogenization approaches in the
    solution of the fiber-reinforced hyperelastic (Hencky constitutive model) composite equilibrium problem under shear
    strain loading conditions: \subref{subfig:hencky_2D_shear_material_response} Homogenized material response; \subref{subfig:hencky_2D_shear_material_response_error} Relative error of the homogenized material response obtained with the FFT approach relative to the FEM approach; \subref{subfig:hencky_2D_shear_strain_12} Local strain field at full load (\(n_v = 600 \times 600\) discretization). Notation: quadratic element (Q).}
\label{fig:hencky_mat_res_2D_shear}
\end{figure}

\begin{table}[htbp]
  \caption{Comparison between the CPU time required by the FFT-based and FEM-based homogenization approaches in the
  solution of the fiber-reinforced hyperelastic (Hencky constitutive model) composite equilibrium problem under uniaxial and pure
  strain loading conditions (\(n_v = 600 \times 600\)).}
\label{tab:hencky_2D_cpu_time}
  \centering
    \begin{tabular}{
       c
       S[
       scientific-notation = true,
         table-format=1.2e-2,
                   round-mode=places,
         round-precision=2
         ]
       S[
       scientific-notation = true,
         table-format=1.2e-2,
                   round-mode=places,
         round-precision=2
         ]
      }
    & \multicolumn{2}{c}{CPU Time (s)} \\ \cline{2-3}
    \vphantom{\Big |}Loading scheme & {FFT} & {FEM} \\
    \hline\hline
    \vphantom{\Big |}Uniaxial strain & 11584.797 & 0.1201E+05 \\
    Pure shear strain & 11415.007 & 0.1197E+05  \\
    \hline\hline
  \end{tabular}
\end{table}

\begin{table}[htbp]
  \caption{Time profile for the FFT-based homogenization approach in the
  solution of the fiber-reinforced hyperelastic (Hencky constitutive model) composite equilibrium problem under uniaxial strain loading conditions (\(n_v = 600 \times 600\)).}
\label{tab:hencky_normal_2D_time_profile}
  \centering
    \begin{tabular}{
       l
       S[
       scientific-notation = true,
         table-format=1.2e-2,
                   round-mode=places,
         round-precision=2
         ]
       S[
        round-mode=places,
         round-precision=2
         ]
      }
    \vphantom{\Big |}Phase & {Duration (s)} & {Duration (\%)} \\
    \hline\hline
     Assembling material constitutive functions        &     3.091 &  0.0266815\\
    	 \makecell[l]{Setting up projection operator\\  and the generator for the equilibrium operator}      &                  0.058   & 0.000500656\\

    	State update                                 &      10632.6   & 91.7804\\
    	Applying projection operator          &               700.742  & 6.04881\\
      Other & 263.51 & 2.271 \\
      \hline
      \vphantom{\Big |}Total time       & 1.16e04 & \\
    \hline\hline
  \end{tabular}
\end{table}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_3D_normal_material_response}
    \caption{}
    \label{subfig:hencky_3D_normal_material_response}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_3D_normal_material_response_error}
    \caption{}
    \label{subfig:hencky_3D_normal_material_response_error}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_mat_res_3D_normal_strain_11}
    \caption{}
    \label{subfig:hencky_mat_res_3D_normal_strain_11}
  \end{subfigure}
  \caption{Comparison between the FFT-based and FEM-based homogenization approaches in the
  solution of the particle-reinforced hyperelastic (Hencky constitutive model) composite equilibrium problem under uniaxial strain loading conditions: \subref{subfig:hencky_3D_normal_material_response} Homogenized material response; \subref{subfig:hencky_3D_normal_material_response_error} Relative error of the homogenized material response obtained with the FFT approach relative to the FEM approach; \subref{subfig:hencky_mat_res_3D_normal_strain_11} Local strain field at full load (\(n_v = 70 \times 70\times 70\)
  discretization). Notation: quadratic element (Q).}
\label{fig:hencky_mat_res_3D_normal}
\end{figure}

\begin{table}[htbp]
  \caption{Comparison between the CPU time required by the FFT-based and FEM-based homogenization approaches in the
  solution of the particle-reinforced hyperelastic (Hencky constitutive model) composite equilibrium problem under the uniaxial strain loading condition (\(n_v = 70 \times 70 \times 70\)).}
\label{tab:hencky_3D_cpu_time}
  \centering
    \begin{tabular}{
       c
       S[
       scientific-notation = true,
         table-format=1.2e-2,
                   round-mode=places,
         round-precision=2
         ]
       S[
       scientific-notation = true,
         table-format=1.2e-2,
                   round-mode=places,
         round-precision=2
         ]
      }
    & \multicolumn{2}{c}{CPU Time (s)} \\ \cline{2-3}
    \vphantom{\Big |}Loading scheme & {FFT} & {FEM} \\
    \hline\hline
    \vphantom{\Big |}Uniaxial strain & 1.56e+04 & 0.3871E+06 \\
    \hline\hline
  \end{tabular}
\end{table}

% No convergence study is done due to time, memory constraints so 70x70x70

% \begin{figure}[hbt] % incomplete
% \label{fig:hencky_mat_res_3D_normal}
% \end{figure}
%
% \begin{figure}[hbt] % incomplete
% \label{fig:hencky_mat_res_3D_shear}
% \end{figure}

\FloatBarrier

\subparagraph{Saint Venant-Kirchhoff model}
\label{sec:svk_accuracy_validation}

The numerical results of the fiber-reinforced hyperelastic (Saint Venant-Kirchhoff) composite equilibrium problem are shown in Figures~\ref{fig:svk_mat_res_2D_normal} and \ref{fig:svk_mat_res_2D_shear} for the uniaxial and pure shear loading cases, respectively.

In both cases there is an excellent agreement between the FFT and FEM-based homogenization solutions concerning both the homogenized response (see Figures~\ref{subfig:svk_2D_normal_material_response}, \ref{subfig:svk_2D_normal_material_response_error}, \ref{subfig:svk_2D_shear_material_response} and \ref{subfig:svk_2D_shear_material_response_error} and the local strain fields (see Figure \ref{subfig:svk_2D_normal_strain_11}).
Moreover, the relative error of the FFT solution when compared for both loading schemes with the FEM solution is very low.
Under 0.1\% for the uniaxial load and under 0.02\% for the pure shear load.
However, as before it must be kept in mind that the enforced deformation is not very large as can be seen from the relatively small deviation of the material response from linear behavior.
The deformation values are conservative for a hyperelastic material because the FEM solutions fail to converge for more demanding values with 200 load increments.
In Figure~\ref{fig:svk_mat_res_2D_shear}, it can be seen that the FEM procedure did not reach the full load for the pure shear loading scheme enforced in 200 increments.

In terms of computational performance, Table~\ref{tab:svk_2D_cpu_time} shows that the FTT approach is three times faster than the FEM approach.
Comparing with Table~\ref{tab:svk_2D_cpu_time}, one can also conclude that solving the fiber-reinforced hyperelastic composite equilibrium problem using FFT is also three times faster when modeling both phases using the Saint Venant-Kirchhoff constitutive model than the Hencky constitutive model.
Looking at Table~\ref{tab:svk_normal_2D_time_profile}, where the time profile for the FFT-based homogenization approach under uniaxial loading conditions is shown it can be understood why.
The difference can be found in the time taken by the state update procedure, as the application of the projection operator takes about the same time \((\SI{7e2}{\second})\).
This is due to the more convoluted pre and post-processing needed to use the Henkcy constitutive model.
These procedures are also possibly present in the FEM implementation for both models explaining the time difference observed to obtain the final solution.

This is set of results lead to the following conclusions:
\begin{itemize}
  \item There is good agreement between the FFT-Galerkin and FEM solutions (homogenized response and local strain fields);
  \item The FFT-Galerkin method is much faster than the FEM for the Saint Venant-Kirchhoff constitutive model;
  \item The FEM is not able to apply the full load corresponding to the pure shear strain loading scheme in the prescribed number of iterations (200).
\end{itemize}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/svk_2D_normal_material_response}
    \caption{}
    \label{subfig:svk_2D_normal_material_response}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/svk_2D_normal_material_response_error}
    \caption{}
    \label{subfig:svk_2D_normal_material_response_error}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/svk_mat_res_2D_normal_strain_11}
    \caption{}
    \label{subfig:svk_mat_res_2D_normal_strain_11}
  \end{subfigure}
  \caption{Comparison between the FFT-based and FEM-based homogenization approaches in the solution of the fiber-reinforced hyperelastic (Saint Venant-Kirchhoff constitutive model) composite equilibrium problem under uniaxial strain loading conditions: \subref{subfig:svk_2D_normal_material_response} Homogenized material response; \subref{subfig:svk_2D_normal_material_response_error} Relative error of the homogenized material response obtained with the FFT approach relative to the FEM approach; \subref{subfig:svk_mat_res_2D_normal_strain_11} Local strain field at full load (\(n_v = 600 \times 600\) discretization). Notation: quadratic element (Q).}
\label{fig:svk_mat_res_2D_normal}
\end{figure}

\begin{figure}[hbt]
    \centering
  	\begin{subfigure}[b]{0.49\textwidth}
      \centering
      \includegraphics[width=\textwidth]{figures/svk_2D_shear_material_response}
      \caption{}
      \label{subfig:svk_2D_shear_material_response}
    \end{subfigure}
    \begin{subfigure}[b]{0.49\textwidth}
      \centering
      \includegraphics[width=\textwidth]{figures/svk_2D_shear_material_response_error}
      \caption{}
      \label{subfig:svk_2D_shear_material_response_error}
    \end{subfigure}
    \begin{subfigure}[b]{\textwidth}
      \centering
      \includegraphics[width=\textwidth]{figures/svk_mat_res_2D_shear_strain_12}
      \caption{}
      \label{subfig:svk_mat_res_2D_shear_strain_12}
    \end{subfigure}
    \caption{Comparison between the FFT-based and FEM-based homogenization approaches in the
    solution of the fiber-reinforced hyperelastic (Hencky constitutive model) composite equilibrium problem under shear
    strain loading conditions: \subref{subfig:svk_2D_shear_material_response} Homogenized material response; \subref{subfig:svk_2D_shear_material_response_error} Relative error of the homogenized material response obtained with the FFT approach relative to the FEM approach; \subref{subfig:svk_mat_res_2D_shear_strain_12} Local strain field at full load - Only FFT available since the FEM solution did not reach full load (\(n_v = 600 \times 600\) discretization). Notation: quadratic element (Q).}
\label{fig:svk_mat_res_2D_shear}
\end{figure}

\begin{table}[htbp]
  \caption{Comparison between the CPU time required by the FFT-based and FEM-based homogenization approaches in the
  solution of the fiber-reinforced hyperelastic (Saint Venant-Kirchhoff constitutive model) composite equilibrium problem under uniaxial and pure
  strain loading conditions (\(n_v = 600 \times 600\)).}
\label{tab:svk_2D_cpu_time}
  \centering
    \begin{tabular}{
       c
       S[
       scientific-notation = true,
         table-format=1.2e-2,
                   round-mode=places,
         round-precision=2
         ]
       S[
       scientific-notation = true,
         table-format=1.2e-2,
                   round-mode=places,
         round-precision=2
         ]
      }
    & \multicolumn{2}{c}{CPU Time (s)} \\ \cline{2-3}
    \vphantom{\Big |}Loading scheme & {FFT} & {FEM} \\
    \hline\hline
    \vphantom{\Big |}Uniaxial strain & 3546.039 & 0.1190E+05 \\
    Pure shear strain & 3685.453 & {-}  \\
    \hline\hline
  \end{tabular}
\end{table}

\begin{table}[htbp]
  \caption{Time profile for the FFT-based homogenization approach in the
  solution of the fiber-reinforced hyperelastic (Saint Venat-Kirchhoff constitutive model) composite equilibrium problem under uniaxial loading conditions (\(n_v = 600 \times 600\)).}
\label{tab:svk_normal_2D_time_profile}
  \centering
    \begin{tabular}{
       l
       S[
       scientific-notation = true,
         table-format=1.2e-2,
                   round-mode=places,
         round-precision=2
         ]
       S[
        round-mode=places,
         round-precision=2
         ]
      }
    \vphantom{\Big |}Phase & {Duration (s)} & {Duration (\%)} \\
    \hline\hline
    Assembling material constitutive functions       &      2.237 &  0.0630845 \\
  	\makecell[l]{Setting up projection operator\\and the generator for the equilibrium operator}                   &      0.053 &  0.00149463\\
  	State update                                     &   2642.72  & 74.5259\\
  	Applying projection operator                     &    690.331 & 19.4677\\
    Other & 214.66 & 6.047 \\
      \hline
      \vphantom{\Big |}Total time       & 3.55e+03 & \\
    \hline\hline
  \end{tabular}
\end{table}

% No convergence study is done due to time, memory constraints so 70x70x70

% \begin{figure}[hbt] % incomplete
% \label{fig:svk_mat_res_3D_normal}
% \end{figure}
%
% \begin{figure}[hbt] % incomplete
% \label{fig:svk_mat_res_3D_shear}
% \end{figure}

\FloatBarrier

\paragraph{Extreme stiffness ratios between phases}

The following set of results is presented to better comprehend the limitations of the FFT-based methods regarding the stiffness ratio between the phases.
As previously, FEM solutions are used as a comparison standard.

Both phases are assumed to follow either the Hencky constitutive model or the Saint Venant-Kirchhoff model having the same Poisson's ratio, \(\nu=0.3\).
The Young modulus of the matrix is fixed at \(E_1=\SI{100}{\mega\pascal}\) and the ratio between the stiffness of the particles and the matrix, \(K=E_1/E_2\), is made to vary from \num{e-6} to \num{e4} in increments of \(\times \sqrt{10}\).
Periodic boundary conditions are adopted and the following macroscale strain loading case is considered
\begin{equation}
\text { uniaxial: } \bm{F}=\left[\begin{array}{cc}
1.1 & 0  \\
0 & 1
\end{array}\right],
\end{equation}
being enforced in a single load increment.
Only the 2D microstructure is considered due to time and memory constraints.

\subparagraph{Hencky}

The numerical results of the fiber-reinforced hyperelastic (Hencky constitutive model) composite equilibrium problem are shown in Figures~\ref{fig:hencky_2D_normal_stiff_contrast} for the uniaxial loading case.
The FFT approach is not able to converge for very soft particles, more precisely, for stiffness ratios below \num{e-2} using Criterion II.
Criterion I exhibited an even poorer behavior, failing to converge for ratios below \num{e-0.5} and above \num{e2.5}.
For the stiffness ratios where convergence is achieved, there is an excellent agreement between the FFT and FEM-based homogenization solutions concerning the homogenized response as attested by Figure~\ref{subfig:hencky_2D_normal_stress_avg_vs_stiff_ratio}.
In terms of computational performance, Figure~\ref{subfig:hencky_2D_normal_stress_avg_cpu_time_vs_n_voxels} shows that the FFT-based homogenization Galerkin scheme outperforms the FEM-based homogenization with speedups from around 5 at low stiffness contrast to around 2 at the strongest stiffness contrasts, both high and low, relative to the direct solver with quadratic finite elements.
As before, the caveat regarding the parallelization of the Python libraries still applies.

Concerning the local field, an excellent agreement can be observed at both high \((K=E_1/E_2=\num{e4})\) and low \((K=E_1/E_2=\num{e-2})\) stiffness ratios in the matrix phase, as can be seen in Figures~\ref{fig:hencky_2D_stiff_contrast_normal_strain_11} and \ref{fig:hencky_2D_stiff_contrast_normal_stress_11}.
There is also good agreement regarding the local field in the particle phase for the strain field at the low stiffness ratio and the stress field at the high stiffness ratio.
On the other hand, the strain field at the low stiffness ratio and the stress field at the high stiffness ratio exhibit strong oscillations in the particle phase.
In closing, it bears mentioning that this does not affect the accuracy of the homogenized response.

This is set of results lead to the following conclusions:
\begin{itemize}
  \item For the stiffness contrasts where convergence is achieved, there is good agreement between the homogenized response found by the FFT-Galerkin method and the FEM method;
  \item The FFT-Galerkin method was not able to solve for all stiffness ratios, failing for softer particles (\(K<2\));
  \item Regarding the local strain fields, oscillations inside the particle phase can be observed at higher and lower stiffness contrasts;
  \item Efficiency-wise, the FFT-Galerkin method is consistently faster than the FEM method across the complete range of stiffness ratios explored.
  It must be kept in mind, however, that some of the Python libraries are parallelized and that the FEM simulations for this set of results are run with only one core.
\end{itemize}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_2D_normal_stress_avg_vs_stiff_ratio}
    \caption{}
    \label{subfig:hencky_2D_normal_stress_avg_vs_stiff_ratio}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_2D_normal_stress_avg_cpu_time_vs_n_voxels}
    \caption{}
    \label{subfig:hencky_2D_normal_stress_avg_cpu_time_vs_n_voxels}
  \end{subfigure}
  \caption{Comparison between the FFT and FEM-based homogenization approaches in the solution of the particle-reinforced hyperelastic (Hencky constitutive model) composite equilibrium problem under normal strain loading conditions: \subref{subfig:hencky_2D_normal_stress_avg_vs_stiff_ratio} Homogenized stress; \subref{subfig:hencky_2D_normal_stress_avg_cpu_time_vs_n_voxels} Computational time; Notation: quadratic element (Q).}
\label{fig:hencky_2D_normal_stiff_contrast}
\end{figure}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_2D_ratio_-2_normal_strain_11}
    \caption{}
    \label{subfig:hencky_2D_ratio_4_normal_strain_11}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_2D_ratio_4_normal_strain_11}
    \caption{}
    \label{subfig:hencky_2D_ratio_-4_normal_strain_11}
  \end{subfigure}
  \caption{Comparison between the local logarithmic strain field \(\varepsilon_{\mu,xx}\) obtained using
  FFT and FEM-based homogenization approaches in the solution of the fiber-reinforced
  hyperelastic (Hencky constitutive model) composite equilibrium problem under normal strain loading conditions:
  \subref{subfig:linear_2D_ratio_-4_normal_strain_11} Stiffness ratio \(K=E_1/E_2=\num{e-2}\);
  \subref{subfig:linear_2D_ratio_4_normal_strain_11} Stiffness ratio \(K=E_1/E_2=\num{e4}\);
  Notation: quadratic element (Q).}
\label{fig:hencky_2D_stiff_contrast_normal_strain_11}
\end{figure}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_2D_ratio_-2_normal_stress_11}
    \caption{}
    \label{subfig:hencky_2D_ratio_4_normal_stress_11}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/hencky_2D_ratio_4_normal_stress_11}
    \caption{}
    \label{subfig:hencky_2D_ratio_-4_normal_stress_11}
  \end{subfigure}
  \caption{Comparison between the local stress field \(\sigma_{\mu,xx}\) obtained using
  FFT and FEM-based homogenization approaches in the solution of the fiber-reinforced
  hyperelastic (Hencky constitutive model) composite equilibrium problem under normal stress loading conditions:
  \subref{subfig:linear_2D_ratio_-4_normal_stress_11} Stiffness ratio \(K=E_1/E_2=\num{e-2}\);
  \subref{subfig:linear_2D_ratio_4_normal_stress_11} Stiffness ratio \(K=E_1/E_2=\num{e4}\);
  Notation: quadratic element (Q).}
\label{fig:hencky_2D_stiff_contrast_normal_stress_11}
\end{figure}

\FloatBarrier

\subparagraph{Saint Venant-Kirchhoff model}

The numerical results of the fiber-reinforced hyperelastic (Saint Venat-Kirchhoff constitutive model) composite equilibrium problem are shown in Figures~\ref{fig:svk_2D_normal_stiff_contrast} for the uniaxial loading case.
The FFT approach when using Criterion I is not able to converge for stiffness ratios below \num{e-2} and above \num{e2}.
On the other hand, using Criterion II, convergence is achieved for all stiffness ratios.
Moreover, there is an excellent agreement between the FFT and FEM-based homogenization solutions concerning the homogenized response as attested by Figure~\ref{subfig:svk_2D_normal_stress_avg_vs_stiff_ratio}.
In terms of computational performance, Figure~\ref{subfig:svk_2D_normal_stress_avg_cpu_time_vs_n_voxels} shows that the FFT-based homogenization Galerkin scheme outperforms the FEM-based homogenization with speedups from around 25 at low stiffness contrast to around 2 at the strongest stiffness contrasts, both high and low, relative to the direct solver with quadratic finite elements.
As before, the caveat regarding the parallelization of the Python libraries still applies.

Concerning the local field, an excellent agreement can be observed at both high \((K=E_1/E_2=\num{e4})\) and low \((K=E_1/E_2=\num{e-4})\) stiffness ratios in the matrix phase, as can be seen in Figure~\ref{fig:svk_2D_stiff_contrast_normal_strain_11}.
There is also good agreement regarding the local field in the particle phase for the strain field at the low stiffness ratio.
On the other hand, the strain field at the low stiffness ratio exhibits strong oscillations in the particle phase.
Results for the stress fields are not presented as the same stress measure was not available for both homogenization schemes using the Saint Venant-Kirchhoff constitutive model.
In closing, it bears mentioning that this does not affect the accuracy of the homogenized response.

This is set of results lead to the following conclusions:
\begin{itemize}
  \item There is good agreement between the homogenized response found by the FFT-Galerkin method and the FEM method;
  \item The FFT-Galerkin method was able to solve for all stiffness ratios;
  \item Regarding the local strain fields, oscillations inside the particle phase can be observed at higher and lower stiffness contrasts;
  \item Efficiency-wise, the FFT-Galerkin method is consistently faster than the FEM method across the complete range of stiffness ratios explored.
  It must be kept in mind, however, that some of the Python libraries are parallelized and that the FEM simulations for this set of results are run with only one core.
\end{itemize}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/svk_2D_normal_stress_avg_vs_stiff_ratio}
    \caption{}
    \label{subfig:svk_2D_normal_stress_avg_vs_stiff_ratio}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/svk_2D_normal_stress_avg_cpu_time_vs_n_voxels}
    \caption{}
    \label{subfig:svk_2D_normal_stress_avg_cpu_time_vs_n_voxels}
  \end{subfigure}
  \caption{Comparison between the FFT and FEM-based homogenization approaches in the solution of the particle-reinforced hyperelastic (Saint Venant-Kirchhoff constitutive model) composite equilibrium problem under normal strain loading conditions: \subref{subfig:svk_2D_normal_stress_avg_vs_stiff_ratio} Homogenized stress; \subref{subfig:svk_2D_normal_stress_avg_cpu_time_vs_n_voxels} Computational time; Notation: quadratic element (Q).}
\label{fig:svk_2D_normal_stiff_contrast}
\end{figure}

\begin{figure}[hbt]
  \centering
	\begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/svk_2D_ratio_-4_normal_strain_11}
    \caption{}
    \label{subfig:svk_2D_ratio_4_normal_strain_11}
  \end{subfigure}
  \begin{subfigure}[b]{\textwidth}
    \centering
    \includegraphics[width=\textwidth]{figures/svk_2D_ratio_4_normal_strain_11}
    \caption{}
    \label{subfig:svk_2D_ratio_-4_normal_strain_11}
  \end{subfigure}
  \caption{Comparison between the local strain field \(F_{\mu,xx}\) obtained using
  FFT and FEM-based homogenization approaches in the solution of the fiber-reinforced
  hyperelastic (Hencky constitutive model) composite equilibrium problem under normal strain loading conditions:
  \subref{subfig:linear_2D_ratio_-4_normal_strain_11} Stiffness ratio \(K=E_1/E_2=\num{e-4}\);
  \subref{subfig:linear_2D_ratio_4_normal_strain_11} Stiffness ratio \(K=E_1/E_2=\num{e4}\);
  Notation: quadratic element (Q).}
\label{fig:svk_2D_stiff_contrast_normal_strain_11}
\end{figure}

\FloatBarrier

\newpage\null\thispagestyle{blank}\newpage
